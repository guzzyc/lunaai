generator client {
  provider = "prisma-client-js"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model company {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @db.VarChar(255)
  website              String?                @db.VarChar(255)
  user_id              Int?
  created_date         DateTime?              @default(now()) @db.DateTime(0)
  tags                 String?                @db.VarChar(255)
  status_id            Int?
  origin_id            Int?
  user                 user?                  @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_ibfk_1")
  company_history      company_history[]
  company_news         company_news[]
  company_note         company_note[]
  lead_deletethistable lead_deletethistable[]
  task                 task[]

  @@index([user_id], map: "user_id")
}

model company_history {
  id           Int       @id @default(autoincrement())
  company_id   Int?
  user_id      Int?
  created_date DateTime? @default(now()) @db.DateTime(0)
  history      String?   @db.Text
  company      company?  @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_history_ibfk_1")
  user         user?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_history_ibfk_2")

  @@index([company_id], map: "company_id")
  @@index([user_id], map: "user_id")
}

model company_news {
  id         Int      @id @default(autoincrement())
  news_id    Int?
  company_id Int?
  news       news?    @relation(fields: [news_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_news_ibfk_1")
  company    company? @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_news_ibfk_2")

  @@index([company_id], map: "company_id")
  @@index([news_id], map: "news_id")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model definition {
  id          Int       @id @default(autoincrement())
  create_time DateTime? @db.DateTime(0)
  name        String?   @db.VarChar(255)
  value       String?   @db.VarChar(1000)
}

model news {
  id             Int            @id @default(autoincrement())
  published_date DateTime?      @db.DateTime(0)
  news_source_id Int?
  url            String?        @db.VarChar(2048)
  content        String?        @db.Text
  time_stamp     DateTime?      @db.DateTime(0)
  author         String?        @db.VarChar(255)
  header         String?        @db.Text
  invalid        Int?           @default(0)
  external_id    String?        @db.VarChar(45)
  rich_content   String?        @db.Text
  company_news   company_news[]
  news_source    news_source?   @relation(fields: [news_source_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "news_ibfk_1")
  news_training  news_training[]

  @@index([news_source_id], map: "source_id")
  @@index([url(length: 255)], map: "idx_news_url")
}

model news_source {
  id   Int    @id @default(autoincrement())
  name String @db.VarChar(255)
  news news[]
}

model task {
  id       Int          @id @default(autoincrement())
  comp_id  Int?
  status   task_status?
  due_date DateTime?    @db.DateTime(0)
  user_id  Int?
  company  company?     @relation(fields: [comp_id], references: [id], onDelete: Cascade, map: "task_ibfk_1")
  user     user?        @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "task_ibfk_2")

  @@index([user_id], map: "user_id")
  @@index([comp_id], map: "comp_id")
}

model user {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @db.VarChar(255)
  created_date         DateTime?              @default(now()) @db.DateTime(0)
  password             String                 @db.VarChar(255)
  role                 String?                @db.VarChar(50)
  email                String                 @unique(map: "unique_email_idx") @db.VarChar(255)
  passwordResetToken   String?                @db.VarChar(255)
  passwordResetExpiry  DateTime?              @db.DateTime(0)
  company              company[]
  company_history      company_history[]
  company_note         company_note[]
  lead_deletethistable lead_deletethistable[]
  task                 task[]
}

model company_note {
  id           Int       @id @default(autoincrement())
  company_id   Int?
  user_id      Int?
  created_date DateTime? @default(now()) @db.DateTime(0)
  note         String?   @db.Text
  company      company?  @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_note_ibfk_1")
  user         user?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "company_note_ibfk_2")

  @@index([company_id], map: "company_id")
  @@index([user_id], map: "user_id")
}

model news_training {
  id         Int       @id @default(autoincrement())
  news_id    Int?
  like       Int?
  category   String?   @db.VarChar(255)
  user_id    Int?
  time_stamp DateTime? @db.DateTime(0)
  feedback   String?   @db.TinyText

  news       news?     @relation(fields: [news_id], references: [id])
}

model company_document {
  id      Int @id @default(autoincrement())
  comp_id Int
  doc_id  Int
}

model document {
  id           Int       @id @default(autoincrement())
  name         String?   @db.VarChar(500)
  user_id      Int?
  date_created DateTime? @db.DateTime(0)
}

model lead_deletethistable {
  id           Int       @id @default(autoincrement())
  company_id   Int?
  created_date DateTime? @default(now()) @db.DateTime(0)
  user_id      Int?
  note         String?   @db.Text
  source_id    Int?
  company      company?  @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "lead_deletethistable_ibfk_1")
  user         user?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "lead_deletethistable_ibfk_2")

  @@index([company_id], map: "company_id")
  @@index([source_id], map: "source_id")
  @@index([user_id], map: "user_id")
}

model news_bad_log {
  id        BigInt    @id @unique(map: "uq_news_bad_log_id") @default(autoincrement())
  user_id   Int?
  news_id   Int?
  show_date DateTime? @db.DateTime(0)
}

model news_dashboard {
  id          Int       @id
  source_id   Int?
  day         DateTime? @db.Date
  count_day   Int?
  week        DateTime? @db.Date
  count_week  Int?
  month       DateTime? @db.Date
  count_month Int?
  year        Int?
  count_year  Int?

  @@unique([source_id, day], map: "indexday")
  @@unique([source_id, month], map: "indexmonth")
  @@unique([source_id, week], map: "indexweek")
  @@unique([source_id, year], map: "indexyear")
}

enum task_status {
  pending
  in_progress
  completed
  blocked
}
